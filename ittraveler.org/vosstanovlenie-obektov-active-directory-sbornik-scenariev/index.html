<!DOCTYPE html>
<html lang="ru-RU"
prefix="og: https://ogp.me/ns#" >
<head>
<meta charset="UTF-8" />
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<link rel="shortcut icon" href="../favicon.png"/>
<link rel="stylesheet" href="http://ittraveler.org/wp-content/themes/diarjo-lite/style.css" media="screen" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.2, user-scalable=yes" />
<!--[if IE 8]>
<script src="http://ittraveler.org/wp-content/themes/diarjo-lite/scripts/html5.js" type="text/javascript"></script>
<script src="http://ittraveler.org/wp-content/themes/diarjo-lite/scripts/selectivizr-min.js" type="text/javascript"></script>
<![endif]-->
<!-- All in One SEO 4.1.6.2 -->
<title>Восстановление объектов Active Directory: сборник сценариев | IT Traveler</title>
<meta name="description" content="Восстановление объектов Active Directory: сборник сценариев" />
<meta name="robots" content="max-image-preview:large" />
<meta name="keywords" content="active directory,adrestore,get-adobject,ldp.exe,ntdsutil" />
<link rel="canonical" href="../index.html@p=46.html" />
<meta property="og:locale" content="ru_RU" />
<meta property="og:site_name" content="IT Traveler | Заметки одного системного администратора о Powershell, Exchange, Windows, Linux, и многом другом..." />
<meta property="og:type" content="article" />
<meta property="og:title" content="Восстановление объектов Active Directory: сборник сценариев | IT Traveler" />
<meta property="og:description" content="Восстановление объектов Active Directory: сборник сценариев" />
<meta property="og:url" content="http://ittraveler.org/vosstanovlenie-obektov-active-directory-sbornik-scenariev/" />
<meta property="article:published_time" content="2014-12-30T07:42:15+00:00" />
<meta property="article:modified_time" content="2014-12-30T13:44:27+00:00" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="Восстановление объектов Active Directory: сборник сценариев | IT Traveler" />
<meta name="twitter:description" content="Восстановление объектов Active Directory: сборник сценариев" />
<meta name="google" content="nositelinkssearchbox" />
<script type="application/ld+json" class="aioseo-schema">
{"@context":"https:\/\/schema.org","@graph":[{"@type":"WebSite","@id":"http:\/\/ittraveler.org\/#website","url":"http:\/\/ittraveler.org\/","name":"IT Traveler","description":"\u0417\u0430\u043c\u0435\u0442\u043a\u0438 \u043e\u0434\u043d\u043e\u0433\u043e \u0441\u0438\u0441\u0442\u0435\u043c\u043d\u043e\u0433\u043e \u0430\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0430\u0442\u043e\u0440\u0430 \u043e Powershell, Exchange, Windows, Linux, \u0438 \u043c\u043d\u043e\u0433\u043e\u043c \u0434\u0440\u0443\u0433\u043e\u043c...","inLanguage":"ru-RU","publisher":{"@id":"http:\/\/ittraveler.org\/#organization"}},{"@type":"Organization","@id":"http:\/\/ittraveler.org\/#organization","name":"IT Traveler","url":"http:\/\/ittraveler.org\/"},{"@type":"BreadcrumbList","@id":"http:\/\/ittraveler.org\/vosstanovlenie-obektov-active-directory-sbornik-scenariev\/#breadcrumblist","itemListElement":[{"@type":"ListItem","@id":"http:\/\/ittraveler.org\/#listItem","position":1,"item":{"@type":"WebPage","@id":"http:\/\/ittraveler.org\/","name":"\u0413\u043b\u0430\u0432\u043d\u0430\u044f","description":"\u0417\u0430\u043c\u0435\u0442\u043a\u0438 \u043e\u0434\u043d\u043e\u0433\u043e \u0441\u0438\u0441\u0442\u0435\u043c\u043d\u043e\u0433\u043e \u0430\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0430\u0442\u043e\u0440\u0430 \u043e Powershell, Exchange, Windows, Linux, \u0438 \u043c\u043d\u043e\u0433\u043e\u043c \u0434\u0440\u0443\u0433\u043e\u043c...","url":"http:\/\/ittraveler.org\/"},"nextItem":"http:\/\/ittraveler.org\/vosstanovlenie-obektov-active-directory-sbornik-scenariev\/#listItem"},{"@type":"ListItem","@id":"http:\/\/ittraveler.org\/vosstanovlenie-obektov-active-directory-sbornik-scenariev\/#listItem","position":2,"item":{"@type":"WebPage","@id":"http:\/\/ittraveler.org\/vosstanovlenie-obektov-active-directory-sbornik-scenariev\/","name":"\u0412\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u043e\u0431\u044a\u0435\u043a\u0442\u043e\u0432 Active Directory: \u0441\u0431\u043e\u0440\u043d\u0438\u043a \u0441\u0446\u0435\u043d\u0430\u0440\u0438\u0435\u0432","description":"\u0412\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u043e\u0431\u044a\u0435\u043a\u0442\u043e\u0432 Active Directory: \u0441\u0431\u043e\u0440\u043d\u0438\u043a \u0441\u0446\u0435\u043d\u0430\u0440\u0438\u0435\u0432","url":"http:\/\/ittraveler.org\/vosstanovlenie-obektov-active-directory-sbornik-scenariev\/"},"previousItem":"http:\/\/ittraveler.org\/#listItem"}]},{"@type":"Person","@id":"http:\/\/ittraveler.org\/author\/mercury131\/#author","url":"http:\/\/ittraveler.org\/author\/mercury131\/","name":"Admin","image":{"@type":"ImageObject","@id":"http:\/\/ittraveler.org\/vosstanovlenie-obektov-active-directory-sbornik-scenariev\/#authorImage","url":"http:\/\/0.gravatar.com\/avatar\/6f127973770f16313582605de016c606?s=96&d=mm&r=g","width":96,"height":96,"caption":"Admin"}},{"@type":"WebPage","@id":"http:\/\/ittraveler.org\/vosstanovlenie-obektov-active-directory-sbornik-scenariev\/#webpage","url":"http:\/\/ittraveler.org\/vosstanovlenie-obektov-active-directory-sbornik-scenariev\/","name":"\u0412\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u043e\u0431\u044a\u0435\u043a\u0442\u043e\u0432 Active Directory: \u0441\u0431\u043e\u0440\u043d\u0438\u043a \u0441\u0446\u0435\u043d\u0430\u0440\u0438\u0435\u0432 | IT Traveler","description":"\u0412\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u043e\u0431\u044a\u0435\u043a\u0442\u043e\u0432 Active Directory: \u0441\u0431\u043e\u0440\u043d\u0438\u043a \u0441\u0446\u0435\u043d\u0430\u0440\u0438\u0435\u0432","inLanguage":"ru-RU","isPartOf":{"@id":"http:\/\/ittraveler.org\/#website"},"breadcrumb":{"@id":"http:\/\/ittraveler.org\/vosstanovlenie-obektov-active-directory-sbornik-scenariev\/#breadcrumblist"},"author":"http:\/\/ittraveler.org\/author\/mercury131\/#author","creator":"http:\/\/ittraveler.org\/author\/mercury131\/#author","datePublished":"2014-12-30T07:42:15+03:00","dateModified":"2014-12-30T13:44:27+03:00"},{"@type":"Article","@id":"http:\/\/ittraveler.org\/vosstanovlenie-obektov-active-directory-sbornik-scenariev\/#article","name":"\u0412\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u043e\u0431\u044a\u0435\u043a\u0442\u043e\u0432 Active Directory: \u0441\u0431\u043e\u0440\u043d\u0438\u043a \u0441\u0446\u0435\u043d\u0430\u0440\u0438\u0435\u0432 | IT Traveler","description":"\u0412\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u043e\u0431\u044a\u0435\u043a\u0442\u043e\u0432 Active Directory: \u0441\u0431\u043e\u0440\u043d\u0438\u043a \u0441\u0446\u0435\u043d\u0430\u0440\u0438\u0435\u0432","inLanguage":"ru-RU","headline":"\u0412\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u043e\u0431\u044a\u0435\u043a\u0442\u043e\u0432 Active Directory: \u0441\u0431\u043e\u0440\u043d\u0438\u043a \u0441\u0446\u0435\u043d\u0430\u0440\u0438\u0435\u0432","author":{"@id":"http:\/\/ittraveler.org\/author\/mercury131\/#author"},"publisher":{"@id":"http:\/\/ittraveler.org\/#organization"},"datePublished":"2014-12-30T07:42:15+03:00","dateModified":"2014-12-30T13:44:27+03:00","articleSection":"Active Directory, PowerShell, Windows, Windows Server, Active Directory, adrestore, Get-ADObject, ldp.exe, NTDSUTIL","mainEntityOfPage":{"@id":"http:\/\/ittraveler.org\/vosstanovlenie-obektov-active-directory-sbornik-scenariev\/#webpage"},"isPartOf":{"@id":"http:\/\/ittraveler.org\/vosstanovlenie-obektov-active-directory-sbornik-scenariev\/#webpage"},"image":{"@type":"ImageObject","@id":"http:\/\/ittraveler.org\/#articleImage","url":"http:\/\/habrastorage.org\/storage2\/437\/a4f\/5fb\/437a4f5fbb34a0beaee32dd717b312e7.png"}}]}
</script>
<!-- All in One SEO -->
<link rel='dns-prefetch' href='http://fonts.googleapis.com/' />
<link rel='dns-prefetch' href='http://s.w.org/' />
<link rel="alternate" type="application/rss+xml" title="IT Traveler &raquo; Лента" href="../feed/index.html" />
<link rel="alternate" type="application/rss+xml" title="IT Traveler &raquo; Лента комментариев" href="../comments/feed/index.html" />
<link rel="alternate" type="application/rss+xml" title="IT Traveler &raquo; Лента комментариев к &laquo;Восстановление объектов Active Directory: сборник сценариев&raquo;" href="feed/index.html" />
<script type="text/javascript">
window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.1.0\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.1.0\/svg\/","svgExt":".svg","source":{"concatemoji":"http:\/\/ittraveler.org\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.8.3"}};
!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode;p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0);e=i.toDataURL();return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([10084,65039,8205,55357,56613],[10084,65039,8203,55357,56613])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(n=t.source||{}).concatemoji?c(n.concatemoji):n.wpemoji&&n.twemoji&&(c(n.twemoji),c(n.wpemoji)))}(window,document,window._wpemojiSettings);
</script>
<style type="text/css">
img.wp-smiley,
img.emoji {
display: inline !important;
border: none !important;
box-shadow: none !important;
height: 1em !important;
width: 1em !important;
margin: 0 .07em !important;
vertical-align: -0.1em !important;
background: none !important;
padding: 0 !important;
}
</style>
<!-- <link rel='stylesheet' id='crayon-css'  href='http://ittraveler.org/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta' type='text/css' media='all' /> -->
<!-- <link rel='stylesheet' id='wp-block-library-css'  href='http://ittraveler.org/wp-includes/css/dist/block-library/style.min.css?ver=5.8.3' type='text/css' media='all' /> -->
<!-- <link rel='stylesheet' id='easy-wp-page-nav-css'  href='http://ittraveler.org/wp-content/plugins/easy-wp-page-navigation//css/easy-wp-pagenavigation.css?ver=1.1' type='text/css' media='all' /> -->
<!-- <link rel='stylesheet' id='template-css'  href='http://ittraveler.org/wp-content/themes/diarjo-lite/css/template.css?ver=5.8.3' type='text/css' media='all' /> -->
<!-- <link rel='stylesheet' id='prettyPhoto-css'  href='http://ittraveler.org/wp-content/themes/diarjo-lite/css/prettyPhoto.css?ver=5.8.3' type='text/css' media='all' /> -->
<!-- <link rel='stylesheet' id='font-awesome.min-css'  href='http://ittraveler.org/wp-content/themes/diarjo-lite/css/font-awesome.min.css?ver=5.8.3' type='text/css' media='all' /> -->
<!-- <link rel='stylesheet' id='bootstrap.theme.min-css'  href='http://ittraveler.org/wp-content/themes/diarjo-lite/css/bootstrap.theme.min.css?ver=5.8.3' type='text/css' media='all' /> -->
<!-- <link rel='stylesheet' id='bootstrap.min-css'  href='http://ittraveler.org/wp-content/themes/diarjo-lite/css/bootstrap.min.css?ver=5.8.3' type='text/css' media='all' /> -->
<link rel="stylesheet" type="text/css" href="../wp-content/cache/wpfc-minified/lk8flrzc/5xnfo.css" media="all"/>
<link rel='stylesheet' id='google-fonts-css'  href='http://fonts.googleapis.com/css?family=Delius+Swash+Caps%7CFjalla+One%7CRoboto+Slab%3A400%2C300%2C100%2C700&amp;ver=5.8.3' type='text/css' media='all' />
<!-- <link rel='stylesheet' id='rpt_front_style-css'  href='http://ittraveler.org/wp-content/plugins/related-posts-thumbnails/assets/css/front.css?ver=1.9.0' type='text/css' media='all' /> -->
<link rel="stylesheet" type="text/css" href="../wp-content/cache/wpfc-minified/q4ywfzv/5xb28.css" media="all"/>
<!-- <link rel='stylesheet' id='lightboxStyle-css'  href='http://ittraveler.org/wp-content/plugins/lightbox-plus/css/shadowed/colorbox.min.css?ver=2.7.2' type='text/css' media='screen' /> -->
<link rel="stylesheet" type="text/css" href="../wp-content/cache/wpfc-minified/fpb25mbt/5xb28.css" media="screen"/>
<script src='../wp-content/cache/wpfc-minified/qhz4e91/5xb28.js' type="text/javascript"></script>
<!-- <script type='text/javascript' src='http://ittraveler.org/wp-includes/js/jquery/jquery.min.js?ver=3.6.0' id='jquery-core-js'></script> -->
<!-- <script type='text/javascript' src='http://ittraveler.org/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.3.2' id='jquery-migrate-js'></script> -->
<script type='text/javascript' id='crayon_js-js-extra'>
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"http:\/\/ittraveler.org\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script src='../wp-content/cache/wpfc-minified/dsx2h32j/5xb28.js' type="text/javascript"></script>
<!-- <script type='text/javascript' src='http://ittraveler.org/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta' id='crayon_js-js'></script> -->
<link rel="https://api.w.org/" href="../wp-json/index.html" /><link rel="alternate" type="application/json" href="../wp-json/wp/v2/posts/46" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="../xmlrpc.php@rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="../wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.8.3" />
<link rel='shortlink' href='../index.html@p=46.html' />
<link rel="alternate" type="application/json+oembed" href="../wp-json/oembed/1.0/embed@url=http%253A%252F%252Fittraveler.org%252Fvosstanovlenie-obektov-active-directory-sbornik-scenariev%252F" />
<link rel="alternate" type="text/xml+oembed" href="../wp-json/oembed/1.0/embed@url=http%253A%252F%252Fittraveler.org%252Fvosstanovlenie-obektov-active-directory-sbornik-scenariev%252F&amp;format=xml" />
<style type="text/css">
.sfs-subscriber-count { width: 88px; overflow: hidden; height: 26px; color: #424242; font: 9px Verdana, Geneva, sans-serif; letter-spacing: 1px; }
.sfs-count { width: 86px; height: 17px; line-height: 17px; margin: 0 auto; background: #ccc; border: 1px solid #909090; border-top-color: #fff; border-left-color: #fff; }
.sfs-count span { display: inline-block; height: 11px; line-height: 12px; margin: 2px 1px 2px 2px; padding: 0 2px 0 3px; background: #e4e4e4; border: 1px solid #a2a2a2; border-bottom-color: #fff; border-right-color: #fff; }
.sfs-stats { font-size: 6px; line-height: 6px; margin: 1px 0 0 1px; word-spacing: 2px; text-align: center; text-transform: uppercase; }
</style>
<style type="text/css">#header, #footer, #sidebar .post-article, #back-to-top i, nav#mainmenu ul ul, #wp-calendar { background-color: #2D3032; } #sidebar h3.title, #sidebar a, #sidebar p, #sidebar li, #sidebar address,
#sidebar dd, #sidebar blockquote, #sidebar td, #sidebar th, #sidebar label, #sidebar .textwidget, #footer h3.title, #footer a, #footer p, #footer li, #footer address,
#footer dd, #footer blockquote, #footer td, #footer th, #footer label, #footer .textwidget, nav#mainmenu ul li a, #back-to-top i, #wp-calendar caption, #wp-calendar td a, #footer h4.title, #logo a, nav#widgetmenu li a { color: #ffffff; } nav#mainmenu ul ul li:last-of-type a, #searchform input[type=submit], .contact-form input[type=submit], #commentform input[type=submit], #sidebar li, #footer li, #footer .widgets, ul.widget-category, ul.widget-category li a, ul.contact-info li, .bottom_widget ul.contact-info li, .tagcloud a, .socials a, #back-to-top i, nav#mainmenu ul li a, #sidebar ul.children, #sidebar ul.sub-menu, #wp-calendar th, #wp-calendar td, nav#widgetmenu ul, nav#widgetmenu li a, nav#widgetmenu li:last-of-type a, nav#widgetmenu li:last-of-type a:hover, #sidebar li, #footer li, #sidebar ul.children, #sidebar ul.children, #footer ul.sub-menu, #sidebar ul.sub-menu { border-color: #444649; } ::-moz-selection { background-color: #eb984e; } ::selection { background-color: #eb984e; } .skills .views, .filter, #searchform input[type=submit], .contact-form input[type=submit], #commentform input[type=submit]{ background-color: #eb984e; } .skills .views, .filter, #searchform input[type=submit], .contact-form input[type=submit], #commentform input[type=submit] { border-color: #eb984e; } #subheader, nav#mainmenu ul li a:hover,nav#mainmenu li:hover > a, nav#mainmenu ul li.current-menu-item > a, nav#mainmenu ul li.current_page_item > a, nav#mainmenu ul li.current-menu-parent > a, nav#mainmenu ul li.current_page_ancestor > a, nav#mainmenu ul li.current-menu-ancestor > a, #back-to-top i.open, #back-to-top i:hover, .post-article .link a:hover, .post-article .quote:hover, .filter li:hover, .filter li.active, ul.widget-category li a:hover, #wp-calendar #today, #wp-calendar #today a, .tagcloud a:hover, .tabs li a:hover, .tabs li.ui-tabs-active a, .tabs li.ui-state-active a, .toggle_container h5.element:hover, .toggle_container h5.inactive, .toggle_container h5.inactive:hover, .socials a:hover, .wp-pagenavi a:hover, .wp-pagenavi span.current, .wip-pagination span, .wip-pagination span:hover, #searchform input[type=submit]:hover, .contact-form input[type=submit]:hover, #commentform input[type=submit]:hover, .skills .views.active, .skills .views:hover, .theme-default .nivo-directionNav a:hover, .flexslider:hover .flex-next:hover, .flexslider:hover .flex-prev:hover, nav#widgetmenu li a:hover, nav#widgetmenu li:hover > a , nav#widgetmenu li.current-menu-item > a, nav#widgetmenu li.current-menu-ancestor > a { background-color: #e67e22; } a.more:hover, a:hover, #footer a:hover, #sidebar a:hover, .post-article .title a:hover, .post-info a:hover, .filterable-grid  h4.title a:hover, .filterable-grid  h4.title a:focus, #logo a:hover, #footer a:hover { color: #e67e22; } nav#mainmenu ul li a:hover,nav#mainmenu li:hover > a,nav#mainmenu ul li.current-menu-item > a, nav#mainmenu ul li.current_page_item > a, nav#mainmenu ul li.current-menu-parent > a, nav#mainmenu ul li.current_page_ancestor > a, nav#mainmenu ul li.current-menu-ancestor > a, nav#mainmenu ul ul li:last-of-type a:hover, nav#mainmenu ul ul li:last-of-type:hover > a, nav#mainmenu ul ul li.current-menu-item > a, nav#mainmenu ul ul li.current_page_item > a, nav#mainmenu ul ul li.current-menu-parent > a, nav#mainmenu ul ul li.current_page_ancestor > a, nav#mainmenu ul ul li.current-menu-ancestor > a, #back-to-top i.open, #back-to-top i:hover, ul.widget-category li a:hover, .tagcloud a:hover, .toggle_container h5.element:hover, .toggle_container h5.inactive, .toggle_container h5.inactive:hover, .toggle_container h5.element:hover:last-of-type, .toggle_container h5.inactive:last-of-type, .toggle_container h5.inactive:hover:last-of-type, .socials a:hover, #searchform input[type=submit]:hover, .contact-form input[type=submit]:hover, #commentform input[type=submit]:hover, nav#widgetmenu li a:hover, nav#widgetmenu li:hover > a , nav#widgetmenu li.current-menu-item > a, nav#widgetmenu li.current-menu-ancestor > a { border-color: #e67e22; } </style>			<style>
#related_posts_thumbnails li{
border-right: 1px solid #dddddd;
background-color: #ffffff			}
#related_posts_thumbnails li:hover{
background-color: #eeeeee;
}
.relpost_content{
font-size:	12px;
color: 		#333333;
}
.relpost-block-single{
background-color: #ffffff;
border-right: 1px solid  #dddddd;
border-left: 1px solid  #dddddd;
margin-right: -1px;
}
.relpost-block-single:hover{
background-color: #eeeeee;
}
</style>
<style type="text/css" id="custom-background-css">
body.custom-background { background-color: #cecece; }
</style>
</head>
<body class="post-template-default single single-post postid-46 single-format-standard custom-background custombody" >
<header id="header">
<div class="container">
<div class="row">
<div class="col-md-12">
<div id="logo">
<a href="../index.html" title="IT Traveler">
IT Traveler
</a>
</div>
<p></p>
Заметки одного системного администратора
<nav id="mainmenu" >
<ul id="menu-menyu" class="menu"><li id="menu-item-14" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-14"><a href="http://www.ittraveler.org">Главная</a></li>
<li id="menu-item-13" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-13"><a href="../category/windows/index.html">Windows</a></li>
<li id="menu-item-15" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15"><a href="../category/linux/index.html">Linux</a></li>
<li id="menu-item-16" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-16"><a href="../category/webcloud/index.html">Web/Cloud</a></li>
<li id="menu-item-17" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-17"><a href="../category/virtualizaciya/index.html">Виртуализация</a></li>
<li id="menu-item-18" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-18"><a href="../category/seti/index.html">Сети</a></li>
<li id="menu-item-778" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-778"><a href="../index.html@p=776.html">Поддержать автора</a></li>
</ul>
</nav> 
<div class="clear"></div>
</div>
</div>
</div>
</header>
<div class="container">
<div class="row">
<div class="col-md-12 full">
<div class="row">
<article class="post-46 post type-post status-publish format-standard hentry category-active-directory category-powershell category-windows category-windows-server tag-active-directory tag-adrestore tag-get-adobject tag-ldp-exe tag-ntdsutil post-container col-md-12" >
<script async src="http://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- Home ittraveler -->
<ins class="adsbygoogle"
style="display:block"
data-ad-client="ca-pub-1890562251101921"
data-ad-slot="9117958896"
data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>                
<div class="post-article post-title">	
<h1 class="title icon-title"> 
Восстановление объектов Active Directory: сборник сценариев                	<span><i class="fa fa-pencil-square-o"></i></span>
</h1>
</div>
<div class="post-article">
<div class="line"> <span> Дата: 30.12.2014 Автор Admin </span> </div>
<p>Несомненно, многие из Вас неоднократно сталкивались с такой проблемой – удалены учетные записи пользователей. Статей по восстановлению учетных записей много, и, наверное, самая лучшая написана Microsoft, однако им всем не хватает наглядности. Мы постараемся преодолеть этот недостаток, сведя процедуру восстановления учетных записей к простым шагам.<br />
Как Вы знаете, восстанавливать объекты можно различными способами, каждый из которых подходит наилучшим образом в той или иной ситуации.<br />
При этом предпочтительным является восстановление из tombstone-объектов. На это есть несколько причин:</p>
<p>&#8212; не требуется выведение контроллера домена в автономный режим (все работают, ничего не отключено)<br />
&#8212; восстановление объектов-захоронений гораздо лучше, чем простое воссоздание новой версии удаленного объекта<span id="more-46"></span></p>
<p>Часть атрибутов удаляется вместе с удалением объекта – их уже не восстановить. Например, членство в группах безопасности.<br />
Если вы вновь создаете объект, он всегда будет иметь новые атрибуты objectGUID и objectSid (если это участник политики безопасности, такой как пользователь). В результате любые внешние ссылки на объект, такие как ACL, необходимо будет обновлять для отражения нового идентификатора объекта. Это может стать очень большой проблемой.<br />
Поэтому в данном посте сначала будут рассмотрены способы, использующие tombstone-объекты, и лишь в конце приведена информация по принудительному восстановлению.</p>
<p>Что необходимо восстановить: пример</p>
<p>Дано:<br />
Из домена acme.com удалена OU Finance_Department с входящими в нее учетными записями Oleg и Dmitry и вложенной OU Admins, в которой находится учетная запись Sergey.<br />
Задача:<br />
Восстановить OU во всеми членами (включая и вложенную OU) и атрибутами учетных записей.</p>
<p>И решаться эта задача будет всеми возможными способами.</p>
<p>1. Восстановление объектов с помощью <a href="../tag/ldp-exe/index.html" class="st_tag internal_tag " rel="tag" title="Posts tagged with ldp.exe">ldp.exe</a></p>
<p>Порядок действий:<br />
1) Включаем отображение в консоли удаленных объектов (CN=Deleted Objects)<br />
Сначала необходимо сделать так, чтобы удаленные объекты отображались (а по умолчанию контейнер CN=Deleted Objects не отображается. Используем <a href="../tag/ldp-exe/index.html" class="st_tag internal_tag " rel="tag" title="Posts tagged with ldp.exe">ldp.exe</a> в Active Directory (требует членства в Domain Admins).<br />
1. Запускаем ldp.exe. (Пуск – Выполнить – ldp.exe)<br />
2. В меню Options (Параметры) выбираем пункт Controls (Элементы управления)</p>
<p><img loading="lazy" class="alignnone" src="http://habrastorage.org/storage2/437/a4f/5fb/437a4f5fbb34a0beaee32dd717b312e7.png" alt="" width="240" height="206" /></p>
<p>3. В появившимся диалоговом окне выбираем меню Load Predefined (Предопределенная перезагрузка), в нем выбираем пункт Return deleted objects (Возврат удаленных объектов) и нажимаем Ок<br />
4. Проверьте, как отображается контейнер удаленных объектов:<br />
a. Чтобы подключиться и выполнить привязку к серверу, на котором находится корневой домен леса среды Active Directory, в разделе Connections (Подключение) выберите пункт Connect (Подключить) и нажмите Bind (Привязка).<br />
b. Нажмите кнопку Обзор, выберите пункт Структура и в поле Distinguished Name (DN) введите DC=,DC=.<br />
c. В дереве консоли дважды щелкните различающееся имя (DN) корневого домена и найдите контейнер CN=Deleted Objects, DC=acme,DC=com.</p>
<p>Восстанавливаем объекты:<br />
Рассмотрим восстановление на примере учетной записи Oleg, входящей в OU Finance_Department.</p>
<p>1) Запускаем ldp.exe<br />
2) В разделе Connections (Подключение) выбираем пункт Connect (Подключить) — Bind (Привязка) Подключаемся и осуществляем привязку к серверу, на котором находится корневой домен леса среды Active Directory</p>
<p><img loading="lazy" class="alignnone" src="http://habrastorage.org/storage2/aeb/268/2ad/aeb2682adda492ed18e47224f9d14d8b.png" alt="" width="240" height="120" /></p>
<p>3) В дереве консоли переходим в контейнер CN=Deleted Objects (прописываем также DC=acme,DC=com для взятого за пример домена)</p>
<p><img loading="lazy" class="alignnone" src="http://habrastorage.org/storage2/29b/419/b98/29b419b98ad2efb7d4e3dc1b4691ae86.gif" alt="" width="315" height="168" /></p>
<p>Результаты поиска</p>
<p><img loading="lazy" class="alignnone" src="http://habrastorage.org/storage2/a7a/4b4/593/a7a4b4593b0f54e0a45e05b532c0c98d.gif" alt="" width="500" height="398" /></p>
<p>4) Находим в оснастке в контейнере CN=Deleted Objects объект, который хотим восстановить, щелкаем правой кнопкой на него и выбираем пункт Modify (Изменить).<br />
5) В окне Modify (Изменение) меняем следующие параметры<br />
a. В поле Edit Entry (Изменить запись) атрибута вводим isDeleted<br />
b. Оставляем поле Values (Значение) пустым<br />
c. В разделе Operation (Операция) выбираем Delete (Удалить) и нажимаем клавишу Enter (ВВОД)</p>
<p><img loading="lazy" class="alignnone" src="http://habrastorage.org/storage2/d09/f51/7cd/d09f517cdfc3795033a891e17bb951db.gif" alt="" width="348" height="378" /></p>
<p>d. В поле Edit Entry Attribute (Изменить запись Атрибута) вводим distinguishedName<br />
e. В поле Values (Значения) вводим первоначальное различающееся имя (DN) этого объекта Active Directory.<br />
f. В разделе Operation (Операция) выбираем Replace (Заменить)<br />
g. Устанавливаем флажок Extended (Расширенный), нажимаем клавишу Enter (ВВОД), а затем Run (Выполнить)</p>
<p>Учетная запись восстановлена, но деактивирована. Включить ее необходимо будет вручную. Также вручную необходимо восстановить членство в группах и сбросить пароль.<br />
Те же самые действия повторяем для оставшихся объектов:<br />
OU Finance_Department<br />
OU Admins<br />
Учетной записи Dmitry<br />
Учетной записи Sergey</p>
<p>Итог:</p>
<p>Необходимо проделать много действий, прежде чем объект будет восстановлен.<br />
Все действия придется повторить для каждого из удаленных объектов.</p>
<p>Используем <a href="../tag/adrestore/index.html" class="st_tag internal_tag " rel="tag" title="Posts tagged with adrestore">ADRESTORE</a></p>
<p>Восстановление объектов-захоронений с помощью LDP дело несложное. Однако неудобное и долгое. Для этих целей есть ADRESTORE, которая предназначена специально для восстановления объектов AD.</p>
<p>Утилита работает в двух режимах:<br />
• Запуск без параметров. Она выведет список всех объектов-захоронений в контейнере CN=Deleted Objects домена по умолчанию. Можно добавить строку для поиска в командной строке, чтобы выбрать объекты для показа:</p>
<p>C:\&gt; <a href="../tag/adrestore/index.html" class="st_tag internal_tag " rel="tag" title="Posts tagged with adrestore">adrestore</a> Finance_Department</p>
<p>Выводятся все объекты в контейнере CN=Deleted Objects, которые содержат строку «Finance_Department» в атрибуте CN или OU — используется поисковый фильтр LDAP cn=*Finance_Department* и ou=*Finance_Department*. На рисунке ниже показаны результаты поиска, возвращенного программой ADRESTORE.</p>
<p>Восстановление объектов<br />
Если нужно восстановить объект-захоронение, а не только найти его, необходимо указать параметр –r вместе с дополнительной строкой, например, вот так:</p>
<p>C:\&gt; adrestore –r Finance_Department</p>
<p>Для восстановления учетных записей используем команды:</p>
<p>C:\&gt; adrestore –r Oleg<br />
C:\&gt; adrestore –r Dmitry<br />
C:\&gt; adrestore –r Admins<br />
C:\&gt; adrestore –r Sergey</p>
<p>Команда предложит восстановить каждый удовлетворяющий условию объект-захоронение. Объект восстанавливается в контейнер, указанный атрибутом lastKnownParent объекта-захоронения (и никакой другой).<br />
Эта команда предложит восстановить каждый подходящий объект-захоронение. <a href="../tag/adrestore/index.html" class="st_tag internal_tag " rel="tag" title="Posts tagged with adrestore">ADRESTORE</a> всегда восстанавливает объект в контейнер, указанный атрибутом lastKnownParent объекта-захоронения, нет никакого способа указать другой контейнер.</p>
<p>Итог:</p>
<p><a href="../tag/adrestore/index.html" class="st_tag internal_tag " rel="tag" title="Posts tagged with adrestore">ADRESTORE</a> легче использовать, чем LDP.<br />
Утилита позволяет относительно быстро восстановить объекты, но опять-таки без необходимых атрибутов — членство в группах и пароли придется восстановить вручную. Один из самых популярных способов восстановления объектов.</p>
<p>Использование AD Recycle Bin (Windows Server 2008 R2)</p>
<p>В Windows Server 2008 R2 появилась корзина Active Directory Recycle Bin (AD RB), Чтобы ее активировать, необходимо, чтобы уровень леса был Windows Server 2008 R2. AD RB напоминает обыкновенную корзину Windows — случайно удаленный объект может быть быстро и со всеми атрибутами восстановлен. Причем восстановленный из AD RB объект сразу же получает и все свои атрибуты. По умолчанию время «жизни» удаленного объекта в AD RB составляет 180 дней, после этого переходит в состояние Recycle Bin Lifetime, теряет атрибуты и через некоторое время полностью удаляется.<br />
В самом простом случае восстановление объекта происходит с помощью <a href="../tag/powershell/index.html" class="st_tag internal_tag " rel="tag" title="Posts tagged with Powershell">Powershell</a> командлетов Get-ADObject и Restore-ADObject (в том случае, если Вы точно знаете, что именно Вам необходимо восстановить). Командлет Get-ADObject используется для извлечения удаленного объекта, который затем передается с помощью конвейера в командлет Restore-ADObject:</p>
<p>1. Запускаем от имени администратора Модуль Active Directory для Windows PowerShell.<br />
2. В командной строке Active Directory module for Windows <a href="../tag/powershell/index.html" class="st_tag internal_tag " rel="tag" title="Posts tagged with Powershell">PowerShell</a> введите следующую команду:</p>
<p>PS C:\&gt; Get-ADObject -Filter {displayName -eq &#171;user&#187;} -IncludeDeletedObjects | Restore-ADObject</p>
<p>В данном примере<br />
-Filter {displayName -eq «user»} указывает, что какую информацию об объекте AD необходимо получить (в примере – об объекте с отображаемым именем пользователя “user),<br />
-IncludeDeletedObjects означает, что поиск осуществляется по удаленным объектам<br />
Restore-ADObject непосредственно осуществляет восстановление объекта AD.</p>
<p>Поиск удаленных объектов<br />
1. Запускаем от имени администратора Модуль Active Directory для Windows PowerShell.<br />
2. В командной строке Active Directory module for Windows <a href="../tag/powershell/index.html" class="st_tag internal_tag " rel="tag" title="Posts tagged with Powershell">PowerShell</a> вводим следующие команды для получения необходимой информации:</p>
<p>Вывод информации об удаленных объектах в домене acme.com</p>
<p>Get-ADObject -SearchBase &#171;CN=Deleted Objects,DC=acme,DC=com&#187;  –IncludeDeletedObjects</p>
<p>Получаем информацию о том, в какой OU состоял удаленный пользователь</p>
<p>Get-ADObject -SearchBase &#171;CN=Deleted Objects,DC=acme,DC=com&#187; -ldapFilter:&#187;(msDs-lastKnownRDN=User)&#187; –IncludeDeletedObjects –Properties lastKnownParent</p>
<p>Где User – отображаемое имя пользователя</p>
<p>В итоге получаем информацию о принадлежности к OU указанного пользователя (с помощью -Properties lastKnownParent)</p>
<p>Поиск всех удаленных объектов, которые входили в данную OU</p>
<p>В качестве примера берем различающееся имя OU Finance_Department, которое было получено после запуска предыдущего командлета (Finance_Department\\0ADEL:e954edda-db8c-41be-bbbd-599bef5a5f2a).</p>
<p>Get-ADObject –SearchBase &#171;CN=Deleted Objects,DC=acme,DC=com&#187; -Filter {lastKnownParent -eq &#8216;OU=Finance_Department\\0ADEL:e954edda-db8c-41be-bbbd-599bef5a5f2a,CN=Deleted Objects,DC=acme,DC=com&#8217;} -IncludeDeletedObjects -Properties lastKnownParent | ft</p>
<p>Внимание! Если у Вас имеется вложенная OU, восстановление осуществляется начиная с наивысшего уровня иерархии. В данном случае таковым является OU=Finance_Department.</p>
<p>Восстановление объектов</p>
<p>1. Запускаем Модуль Active Directory для Windows <a href="../tag/powershell/index.html" class="st_tag internal_tag " rel="tag" title="Posts tagged with Powershell">PowerShell</a><br />
2. Восстанавливаем подразделение Finance_Department, выполнив в командной строке следующую команду:</p>
<p>Get-ADObject -ldapFilter:&#187;(msDS-LastKnownRDN=Finance_Department)&#187; –IncludeDeletedObjects | Restore-ADObject</p>
<p>3. Восстанавливаем учетные записи и OU, которые являются непосредственными дочерними объектами OU Finance_Department (помните, что на этом этапе различающееся имя Finance_Department уже восстановлено в значение OU=Finance_Department,DC=acme,DC=com)</p>
<p>Get-ADObject -SearchBase &#171;CN=Deleted Objects,DC=acme,DC=com&#187; -Filter {lastKnownParent -eq &#171;OU=Finance_Department,DC=acme,DC=com&#187;} -IncludeDeletedObjects | Restore-ADObject</p>
<p>Опционально (восстановление вложенных OU)</p>
<p>4. Восстанавливаем учетные записи, входящие во вложенную OU (например, OU Admins, которая входит в состав OU Finance Department. Различающееся имя в нашем примере было восстановлено в значение OU=Admins,OU=Finance_Department,DC=acme,DC=com)</p>
<p>Get-ADObject -SearchBase &#171;CN=Deleted Objects,DC=acme,DC=com&#187; -Filter {lastKnownParent -eq &#171;OU=Admins,OU=Finance_Department,DC=acme,DC=com&#187;} -IncludeDeletedObjects | Restore-ADObject</p>
<p>Подробную справку о командлетах и их параметрах вызвав командлет Get-Help, например Get-Help Get-ADObject</p>
<p>Итог:<br />
Объекты будут восстановлены в первоначальный вид – со всеми атрибутами.<br />
Однако, как мы можем видеть, данный метод довольно сложен, когда приходится работать с большим количеством объектов.<br />
Также требуется, все сервера в лесу должны быть Windows 2008 R2.<br />
Для восстановления объектов с атрибутами при включенной корзине AD можно использовать описанные выше инструменты LDP и AdRestore.</p>
<p>4. Принудительное восстановление с помощью NTDSUTIL</p>
<p>Стандартным способом (но, однако, не самым подходящим) является принудительное восстановление из резервной копии в режиме Directory Service Restore Mode. Он обладает серьезными недостатками: нужно перезагружать сервер, а во-вторых, восстанавливать из резервной копии состояние системы и помечать, какие объекты не будут перезаписаны процессом репликации.<br />
Восстановление осуществляется с помощью утилиты командной строки NTDSUTIL. Утилита становится доступной после установки роли AD DS. Используя ее, можно восстановить как OU со всем содержимым, так и отдельный объект.<br />
Работа утилиты основана на мгновенных снимках (снапшотах) Active Directory, которые делаются при помощи службы VSS.</p>
<p>Внимание! В ходе принудительного восстановления AD внутренний номер версии восстанавливаемых объектов увеличивается. После подключения контроллера домена к сети эти объекты будут реплицированы по всему домену, а восстановленная версия становится глобально действующей.</p>
<p>Порядок действий:<br />
1. Нам необходимо восстановить OU Finance_Department из домена acme.com<br />
2. Загружаемся в режиме DSRM (в загрузочном меню вызывается нажатием клавиши F8) и выполните регистрацию с паролем, DSRM, заданным во время работы Dcpromo. AD не загружается, база данных переводится в автономный режим.</p>
<p>Внимание! Невозможно выполнить восстановление, если на контроллерах домена Server 2008 и выше остановлена служба NTDS AD.</p>
<p>3. Восстановите системное состояние из резервной копии, созданной до аварии.</p>
<p>Внимание! Не перезагружайте компьютер.</p>
<p>В снимке, полученном при помощи ntdsutil, присутствует как сам объект, так и его атрибуты. Образ можно монтировать и подключать в качестве виртуального LDAP-сервера, экспортирующего объекты. Запускаем ntdsutil:</p>
<p>&gt; ntdsutil<br />
ntdsutil: snapshot</p>
<p>Просматриваем список доступных снимков:</p>
<p>снимок: list all</p>
<p>1: 2009/04/22:23:18 {8378f4fe-94c2-4479-b0e6-ab46b2d88225}</p>
<p>2: C: {732fdf7f-9133-4e62-a7e2-2362227a8c8e}</p>
<p>3: 2009/04/23:00:19 {6f7aca49-8959-4bdf-a668-6172d28ddde6}</p>
<p>4: C: {cd17412a-387b-47d1-9d67-1972f49d6706}</p>
<p>Монтируем командой mount c указанием номера или {ID}:</p>
<p>снимок: mount 4<br />
Снимок {cd17412a-387b-47d1-9d67-1972f49d6706} установлен как C:\$SNAP_200904230019_VOLUMEC$\</p>
<p>Снимок смонтирован.</p>
<p>4. Запустите команду</p>
<p>Для восстановления подразделения Finance_Department</p>
<p>&gt; ntdsutil &#171;authoritative restore&#187; &#171;restore subtree ou=Finance_Department,dc=acme,dc=com&#187; q q</p>
<p>В итоге будет восстановлена OU Finance_Department с входящими в нее учетными записями и вложенной OU Admins<br />
Для восстановления отдельной учетной записи, например, c отображаемым именем Oleg</p>
<p>&gt; ntdsutil &#171;authoritative restore&#187; &#171;restore object cn=Oleg,ou=Finance_Department,dc=acme,dc=com&#187; q q</p>
<p>5. Необходимо подтвердить предупреждения безопасности. Затем будет выдано сообщение, подобное показанному на рисунке 3. Обратите внимание на сформированные текстовые и LDIF-файлы.</p>
<p>Перезагрузите DC в нормальном режиме запуска операционной системы.<br />
7. Зарегистрируйтесь на DC и откройте командную строку. Импортируйте LDIF-файл, экспортированный на шаге 5, выполнив команду</p>
<p>ldifde -i -f<br />
ar_20110221-151131_links_contoso.com.ldf</p>
<p>где ar_20110221-151131_links_contoso.com.ldf – имя созданного LDIF-файла.<br />
8. В результате будут импортированы значения связанных атрибутов (такие, как членство в группах) для восстановленных объектов</p>
<p>Внимание! Если в лесу содержится несколько доменов, необходимо использовать текстовый файл, экспортированный на шаге 6 для восстановления членства в локальных группах других доменов.</p>
<p>Итог:<br />
Учетные записи и объекты восстановлены, однако база Active Directory была недоступна в течение определенного периода времени. Вы также зависите от наличия актуальных баз данных AD, полагаясь на данный метод восстановления.</p>
<p>Источник &#8212; <a href="http://habrahabr.ru/company/netwrix/blog/150460/" target="_blank">http://habrahabr.ru/company/netwrix/blog/150460/</a></p>
<!-- relpost-thumb-wrapper --><div class="relpost-thumb-wrapper"><!-- filter-class --><div class="relpost-thumb-container"><h3>Related posts:</h3><div style="clear: both"></div><div style="clear: both"></div><!-- relpost-block-container --><div class="relpost-block-container"><a class="relpost-block-single" href="../index.html@p=1001.html"><div class="relpost-custom-block-single" style="width: 150px; height: 225px;"><div class="relpost-block-single-image" alt="Настройка растянутого кластера (stretch-cluster) на Windows server 2016"  style="background: transparent url(../wp-content/uploads/2020/04/D094D0B8D0B0D0B3D180D0B0D0BCD0BCD0B01_tdwhya-150x150.png) no-repeat scroll 0% 0%; width: 150px; height: 150px;"></div><div class="relpost-block-single-text"  style="font-family: Arial;  font-size: 12px;  color: #333333;">Настройка растянутого кластера (stretch-cluster) на Windows server 2016</div></div></a><a class="relpost-block-single" href="../otkazoustojchivyj-iscsi-klaster-na-windows-server-2012-r2-2/index.html@replytocom=4145.html"><div class="relpost-custom-block-single" style="width: 150px; height: 225px;"><div class="relpost-block-single-image" alt="Отказоустойчивый ISCSI кластер на Windows Server 2012 R2"  style="background: transparent url(http://ittraveler.org/wp-content/plugins/related-posts-thumbnails/img/default.png) no-repeat scroll 0% 0%; width: 150px; height: 150px;"></div><div class="relpost-block-single-text"  style="font-family: Arial;  font-size: 12px;  color: #333333;">Отказоустойчивый ISCSI кластер на Windows Server 2012 R2</div></div></a><a class="relpost-block-single" href="../index.html@p=834.html"><div class="relpost-custom-block-single" style="width: 150px; height: 225px;"><div class="relpost-block-single-image" alt="Получаем MD5 файла или переменной в Powershell"  style="background: transparent url(http://ittraveler.org/wp-content/plugins/related-posts-thumbnails/img/default.png) no-repeat scroll 0% 0%; width: 150px; height: 150px;"></div><div class="relpost-block-single-text"  style="font-family: Arial;  font-size: 12px;  color: #333333;">Получаем MD5 файла или переменной в Powershell</div></div></a></div><!-- close relpost-block-container --><div style="clear: both"></div></div><!-- close filter class --></div><!-- close relpost-thumb-wrapper --><div class="clear"></div>
<div class="post-info">
<div class="left"> <a href="../category/active-directory/index.html" rel="category tag">Active Directory</a>, <a href="../category/powershell/index.html" rel="category tag">PowerShell</a>, <a href="../category/windows/index.html" rel="category tag">Windows</a>, <a href="../category/windows-server/index.html" rel="category tag">Windows Server</a> </div>
<div class="right"> Метки: <a href="../tag/active-directory/index.html" rel="tag">Active Directory</a>, <a href="../tag/adrestore/index.html" rel="tag">adrestore</a>, <a href="../tag/get-adobject/index.html" rel="tag">Get-ADObject</a>, <a href="../tag/ldp-exe/index.html" rel="tag">ldp.exe</a>, <a href="../tag/ntdsutil/index.html" rel="tag">NTDSUTIL</a>  </div>
</div>
<div class="clear"></div>
<br>
</div>                        
<div style="clear:both"></div>
</article>
<div class="clear"></div>
<section class="col-md-12">
<div id="respond" class="comment-respond">
<h3 id="reply-title" class="comment-reply-title">Добавить комментарий <small><a rel="nofollow" id="cancel-comment-reply-link" href="../index.html@p=46.html#respond" style="display:none;">Отменить ответ</a></small></h3><form action="http://ittraveler.org/wp-comments-post.php" method="post" id="commentform" class="comment-form"><p class="comment-notes"><span id="email-notes">Ваш адрес email не будет опубликован.</span></p><p class="comment-form-comment"><label for="comment">Комментарий</label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea></p><p class="comment-form-author"><label for="author">Имя</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="text" value="" size="30" maxlength="100" aria-describedby="email-notes" /></p>
<p class="comment-form-url"><label for="url">Сайт</label> <input id="url" name="url" type="text" value="" size="30" maxlength="200" /></p>
<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Комментировать" /> <input type='hidden' name='comment_post_ID' value='46' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="29dead7abb" /></p><p style="display: none !important;"><label>&#916;<textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100"></textarea></label><input type="hidden" id="ak_js_1" name="ak_js" value="139"/><script>document.getElementById( "ak_js_1" ).setAttribute( "value", ( new Date() ).getTime() );</script></p></form>	</div><!-- #respond -->
<script async src="http://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- Home ittraveler -->
<ins class="adsbygoogle"
style="display:block"
data-ad-client="ca-pub-1890562251101921"
data-ad-slot="9117958896"
data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</section>
</div>
</div>
<div class="clear"></div>
</div>
</div>
<div id="back-to-top"> <i class="fa fa-chevron-up"></i> </div>
<footer id="footer">
<div class="container">
<div class="row" >
<div class="col-md-12" >
<div class="copyright">
<p>
Все права защищены. IT Traveler 2022 
</p>
</div>
<div class="socials">
<a href="../feed/index.html" title="Rss" class="social rss"> <i class="fa fa-rss" ></i>  </a>                         
</div>
<div class="clear"></div>
</div>
</div>
</div>
</footer>
<!-- Lightbox Plus Colorbox v2.7.2/1.5.9 - 2013.01.24 - Message: 0-->
<script type="text/javascript">
jQuery(document).ready(function($){
$("a[rel*=lightbox]").colorbox({initialWidth:"30%",initialHeight:"30%",maxWidth:"90%",maxHeight:"90%",opacity:0.8,current:" {current}  {total}",previous:"<-",next:"->",close:"Закрыть"});
});
</script>
<script type='text/javascript' src='../wp-includes/js/comment-reply.min.js@ver=5.8.3' id='comment-reply-js'></script>
<script type='text/javascript' src='../wp-includes/js/jquery/ui/core.min.js@ver=1.12.1' id='jquery-ui-core-js'></script>
<script type='text/javascript' src='../wp-includes/js/jquery/ui/tabs.min.js@ver=1.12.1' id='jquery-ui-tabs-js'></script>
<script type='text/javascript' src='http://ittraveler.org/wp-content/themes/diarjo-lite/js/jquery.wip.js?ver=5.8.3' id='jquery.wip-js'></script>
<script type='text/javascript' src='http://ittraveler.org/wp-content/themes/diarjo-lite/js/jquery.tinynav.js?ver=5.8.3' id='jquery.tinynav-js'></script>
<script type='text/javascript' src='http://ittraveler.org/wp-content/themes/diarjo-lite/js/jquery.scrollTo.js?ver=5.8.3' id='jquery.scrollTo-js'></script>
<script type='text/javascript' src='http://ittraveler.org/wp-content/themes/diarjo-lite/js/jquery.prettyPhoto.js?ver=5.8.3' id='jquery.prettyPhoto-js'></script>
<script type='text/javascript' src='http://ittraveler.org/wp-content/themes/diarjo-lite/js/jquery.easing.1.3.js?ver=5.8.3' id='jquery.easing.1.3-js'></script>
<script type='text/javascript' src='http://ittraveler.org/wp-content/plugins/lightbox-plus/js/jquery.colorbox.1.5.9-min.js?ver=1.5.9' id='jquery-colorbox-js'></script>
<script type='text/javascript' src='../wp-includes/js/wp-embed.min.js@ver=5.8.3' id='wp-embed-js'></script>
<!-- Yandex.Metrika counter -->
<script type="text/javascript">
(function (d, w, c) {
(w[c] = w[c] || []).push(function() {
try {
w.yaCounter27780774 = new Ya.Metrika({
id:27780774,
clickmap:true,
trackLinks:true,
accurateTrackBounce:true,
webvisor:true,
trackHash:true
});
} catch(e) { }
});
var n = d.getElementsByTagName("script")[0],
s = d.createElement("script"),
f = function () { n.parentNode.insertBefore(s, n); };
s.type = "text/javascript";
s.async = true;
s.src = "https://mc.yandex.ru/metrika/watch.js";
if (w.opera == "[object Opera]") {
d.addEventListener("DOMContentLoaded", f, false);
} else { f(); }
})(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/27780774" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
<!-- /Yandex.Metrika counter -->
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-58126221-1', 'auto');
ga('send', 'pageview');
</script>
</body>
</html><!-- WP Fastest Cache file was created in 0.48730206489563 seconds, on 28-01-22 22:02:40 -->