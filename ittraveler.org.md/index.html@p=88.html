<!DOCTYPE html>
<html lang="ru-RU">
<head>
<meta charset="UTF-8" />
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<link rel="shortcut icon" href="favicon.png"/>
<title>Управление репликацией Active Directory | IT Traveler</title>
<link rel="stylesheet" href="http://ittraveler.org/wp-content/themes/diarjo-lite/style.css" media="screen" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.2, user-scalable=yes" />
<!--[if IE 8]>
<script src="http://ittraveler.org/wp-content/themes/diarjo-lite/scripts/html5.js" type="text/javascript"></script>
<script src="http://ittraveler.org/wp-content/themes/diarjo-lite/scripts/selectivizr-min.js" type="text/javascript"></script>
<![endif]-->
<!-- All in One SEO Pack 3.2.7 от Michael Torbert из Semper Fi Web Design[225,285] -->
<meta name="description"  content="Управление репликацией Active Directory" />
<meta name="keywords"  content="Управление репликацией active directory,active directory,Репликация" />
<script type="application/ld+json" class="aioseop-schema">{"@context":"https://schema.org","@graph":[{"@type":"Organization","@id":"http://ittraveler.org/#organization","url":"http://ittraveler.org/","name":"IT Traveler","sameAs":[]},{"@type":"WebSite","@id":"http://ittraveler.org/#website","url":"http://ittraveler.org/","name":"IT Traveler","publisher":{"@id":"http://ittraveler.org/#organization"}},{"@type":"WebPage","@id":"http://ittraveler.org/upravlenie-replikaciej-active-directory/#webpage","url":"http://ittraveler.org/upravlenie-replikaciej-active-directory/","inLanguage":"ru-RU","name":"\u0423\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0440\u0435\u043f\u043b\u0438\u043a\u0430\u0446\u0438\u0435\u0439 Active Directory","isPartOf":{"@id":"http://ittraveler.org/#website"},"datePublished":"2014-12-30T09:35:16+00:00","dateModified":"2014-12-30T13:46:33+00:00","description":"\u0423\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0440\u0435\u043f\u043b\u0438\u043a\u0430\u0446\u0438\u0435\u0439 Active Directory"},{"@type":"Article","@id":"http://ittraveler.org/upravlenie-replikaciej-active-directory/#article","isPartOf":{"@id":"http://ittraveler.org/upravlenie-replikaciej-active-directory/#webpage"},"author":{"@id":"http://ittraveler.org/author/mercury131/#author"},"headline":"\u0423\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0440\u0435\u043f\u043b\u0438\u043a\u0430\u0446\u0438\u0435\u0439 Active Directory","datePublished":"2014-12-30T09:35:16+00:00","dateModified":"2014-12-30T13:46:33+00:00","commentCount":0,"mainEntityOfPage":{"@id":"http://ittraveler.org/upravlenie-replikaciej-active-directory/#webpage"},"publisher":{"@id":"http://ittraveler.org/#organization"},"articleSection":"Active Directory, Windows, Windows Server, Active Directory, \u0420\u0435\u043f\u043b\u0438\u043a\u0430\u0446\u0438\u044f"},{"@type":"Person","@id":"http://ittraveler.org/author/mercury131/#author","name":"Admin","sameAs":[],"image":{"@type":"ImageObject","@id":"http://ittraveler.org/#personlogo","url":"http://0.gravatar.com/avatar/6f127973770f16313582605de016c606?s=96&d=mm&r=g","width":96,"height":96,"caption":"Admin"}}]}</script>
<link rel="canonical" href="index.html@p=88.html" />
<!-- All in One SEO Pack -->
<link rel='dns-prefetch' href='http://fonts.googleapis.com/' />
<link rel='dns-prefetch' href='http://s.w.org/' />
<link rel="alternate" type="application/rss+xml" title="IT Traveler &raquo; Лента" href="feed/index.html" />
<link rel="alternate" type="application/rss+xml" title="IT Traveler &raquo; Лента комментариев" href="comments/feed/index.html" />
<link rel="alternate" type="application/rss+xml" title="IT Traveler &raquo; Лента комментариев к &laquo;Управление репликацией Active Directory&raquo;" href="upravlenie-replikaciej-active-directory/feed/index.html" />
<script type="text/javascript">
window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/12.0.0-1\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/12.0.0-1\/svg\/","svgExt":".svg","source":{"concatemoji":"http:\/\/ittraveler.org\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.2.4"}};
!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55357,56424,55356,57342,8205,55358,56605,8205,55357,56424,55356,57340],[55357,56424,55356,57342,8203,55358,56605,8203,55357,56424,55356,57340]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);
</script>
<style type="text/css">
img.wp-smiley,
img.emoji {
display: inline !important;
border: none !important;
box-shadow: none !important;
height: 1em !important;
width: 1em !important;
margin: 0 .07em !important;
vertical-align: -0.1em !important;
background: none !important;
padding: 0 !important;
}
</style>
<!-- <link rel='stylesheet' id='crayon-css'  href='http://ittraveler.org/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta' type='text/css' media='all' /> -->
<!-- <link rel='stylesheet' id='wp-block-library-css'  href='http://ittraveler.org/wp-includes/css/dist/block-library/style.min.css?ver=5.2.4' type='text/css' media='all' /> -->
<!-- <link rel='stylesheet' id='easy-wp-page-nav-css'  href='http://ittraveler.org/wp-content/plugins/easy-wp-page-navigation//css/easy-wp-pagenavigation.css?ver=1.1' type='text/css' media='all' /> -->
<!-- <link rel='stylesheet' id='bootstrap.theme.min-css'  href='http://ittraveler.org/wp-content/themes/diarjo-lite/css/bootstrap.theme.min.css?ver=5.2.4' type='text/css' media='all' /> -->
<!-- <link rel='stylesheet' id='font-awesome.min-css'  href='http://ittraveler.org/wp-content/themes/diarjo-lite/css/font-awesome.min.css?ver=5.2.4' type='text/css' media='all' /> -->
<!-- <link rel='stylesheet' id='prettyPhoto-css'  href='http://ittraveler.org/wp-content/themes/diarjo-lite/css/prettyPhoto.css?ver=5.2.4' type='text/css' media='all' /> -->
<!-- <link rel='stylesheet' id='bootstrap.min-css'  href='http://ittraveler.org/wp-content/themes/diarjo-lite/css/bootstrap.min.css?ver=5.2.4' type='text/css' media='all' /> -->
<!-- <link rel='stylesheet' id='template-css'  href='http://ittraveler.org/wp-content/themes/diarjo-lite/css/template.css?ver=5.2.4' type='text/css' media='all' /> -->
<link rel="stylesheet" type="text/css" href="wp-content/cache/wpfc-minified/efxryr5t/4hxo1.css" media="all"/>
<link rel='stylesheet' id='google-fonts-css'  href='http://fonts.googleapis.com/css?family=Delius+Swash+Caps%7CFjalla+One%7CRoboto+Slab%3A400%2C300%2C100%2C700&amp;ver=5.2.4' type='text/css' media='all' />
<!-- <link rel='stylesheet' id='lightboxStyle-css'  href='http://ittraveler.org/wp-content/plugins/lightbox-plus/css/shadowed/colorbox.min.css?ver=2.7.2' type='text/css' media='screen' /> -->
<link rel="stylesheet" type="text/css" href="wp-content/cache/wpfc-minified/fpb25mbt/4hxnb.css" media="screen"/>
<script src='wp-content/cache/wpfc-minified/e6291fz9/4hxnb.js' type="text/javascript"></script>
<!-- <script type='text/javascript' src='http://ittraveler.org/wp-includes/js/jquery/jquery.js?ver=1.12.4-wp'></script> -->
<!-- <script type='text/javascript' src='http://ittraveler.org/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1'></script> -->
<script type='text/javascript'>
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"http:\/\/ittraveler.org\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script src='wp-content/cache/wpfc-minified/dsx2h32j/4hxnb.js' type="text/javascript"></script>
<!-- <script type='text/javascript' src='http://ittraveler.org/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta'></script> -->
<link rel='https://api.w.org/' href='wp-json/index.html' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="xmlrpc.php@rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='Переход на репликацию SYSVOL по DFS' href='index.html@p=85.html' />
<link rel='next' title='Удаляем неисправный контроллер домена при помощи утилиты NTDSUTIL' href='index.html@p=98.html' />
<meta name="generator" content="WordPress 5.2.4" />
<link rel='shortlink' href='index.html@p=88.html' />
<link rel="alternate" type="application/json+oembed" href="wp-json/oembed/1.0/embed@url=http%253A%252F%252Fittraveler.org%252Fupravlenie-replikaciej-active-directory%252F" />
<link rel="alternate" type="text/xml+oembed" href="wp-json/oembed/1.0/embed@url=http%253A%252F%252Fittraveler.org%252Fupravlenie-replikaciej-active-directory%252F&amp;format=xml" />
<script type="text/javascript">
window._wp_rp_static_base_url = 'https://rp.zemanta.com/static/';
window._wp_rp_wp_ajax_url = "http://ittraveler.org/wp-admin/admin-ajax.php";
window._wp_rp_plugin_version = '3.6.1';
window._wp_rp_post_id = '88';
window._wp_rp_num_rel_posts = '6';
window._wp_rp_thumbnails = false;
window._wp_rp_post_title = '%D0%A3%D0%BF%D1%80%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5+%D1%80%D0%B5%D0%BF%D0%BB%D0%B8%D0%BA%D0%B0%D1%86%D0%B8%D0%B5%D0%B9+Active+Directory';
window._wp_rp_post_tags = ['%D0%A0%D0%B5%D0%BF%D0%BB%D0%B8%D0%BA%D0%B0%D1%86%D0%B8%D1%8F', 'active+directory', '%D0%A3%D0%BF%D1%80%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5+%D1%80%D0%B5%D0%BF%D0%BB', 'active+directory', 'windows', 'windows+server', 'ad', 'microsoft', 'directori', 'activ', 'servic'];
</script>
<style type="text/css">
.sfs-subscriber-count { width: 88px; overflow: hidden; height: 26px; color: #424242; font: 9px Verdana, Geneva, sans-serif; letter-spacing: 1px; }
.sfs-count { width: 86px; height: 17px; line-height: 17px; margin: 0 auto; background: #ccc; border: 1px solid #909090; border-top-color: #fff; border-left-color: #fff; }
.sfs-count span { display: inline-block; height: 11px; line-height: 12px; margin: 2px 1px 2px 2px; padding: 0 2px 0 3px; background: #e4e4e4; border: 1px solid #a2a2a2; border-bottom-color: #fff; border-right-color: #fff; }
.sfs-stats { font-size: 6px; line-height: 6px; margin: 1px 0 0 1px; word-spacing: 2px; text-align: center; text-transform: uppercase; }
</style>
<style type="text/css">#header, #footer, #sidebar .post-article, #back-to-top i, nav#mainmenu ul ul, #wp-calendar { background-color: #2D3032; } #sidebar h3.title, #sidebar a, #sidebar p, #sidebar li, #sidebar address,
#sidebar dd, #sidebar blockquote, #sidebar td, #sidebar th, #sidebar label, #sidebar .textwidget, #footer h3.title, #footer a, #footer p, #footer li, #footer address,
#footer dd, #footer blockquote, #footer td, #footer th, #footer label, #footer .textwidget, nav#mainmenu ul li a, #back-to-top i, #wp-calendar caption, #wp-calendar td a, #footer h4.title, #logo a, nav#widgetmenu li a { color: #ffffff; } nav#mainmenu ul ul li:last-of-type a, #searchform input[type=submit], .contact-form input[type=submit], #commentform input[type=submit], #sidebar li, #footer li, #footer .widgets, ul.widget-category, ul.widget-category li a, ul.contact-info li, .bottom_widget ul.contact-info li, .tagcloud a, .socials a, #back-to-top i, nav#mainmenu ul li a, #sidebar ul.children, #sidebar ul.sub-menu, #wp-calendar th, #wp-calendar td, nav#widgetmenu ul, nav#widgetmenu li a, nav#widgetmenu li:last-of-type a, nav#widgetmenu li:last-of-type a:hover, #sidebar li, #footer li, #sidebar ul.children, #sidebar ul.children, #footer ul.sub-menu, #sidebar ul.sub-menu { border-color: #444649; } ::-moz-selection { background-color: #eb984e; } ::selection { background-color: #eb984e; } .skills .views, .filter, #searchform input[type=submit], .contact-form input[type=submit], #commentform input[type=submit]{ background-color: #eb984e; } .skills .views, .filter, #searchform input[type=submit], .contact-form input[type=submit], #commentform input[type=submit] { border-color: #eb984e; } #subheader, nav#mainmenu ul li a:hover,nav#mainmenu li:hover > a, nav#mainmenu ul li.current-menu-item > a, nav#mainmenu ul li.current_page_item > a, nav#mainmenu ul li.current-menu-parent > a, nav#mainmenu ul li.current_page_ancestor > a, nav#mainmenu ul li.current-menu-ancestor > a, #back-to-top i.open, #back-to-top i:hover, .post-article .link a:hover, .post-article .quote:hover, .filter li:hover, .filter li.active, ul.widget-category li a:hover, #wp-calendar #today, #wp-calendar #today a, .tagcloud a:hover, .tabs li a:hover, .tabs li.ui-tabs-active a, .tabs li.ui-state-active a, .toggle_container h5.element:hover, .toggle_container h5.inactive, .toggle_container h5.inactive:hover, .socials a:hover, .wp-pagenavi a:hover, .wp-pagenavi span.current, .wip-pagination span, .wip-pagination span:hover, #searchform input[type=submit]:hover, .contact-form input[type=submit]:hover, #commentform input[type=submit]:hover, .skills .views.active, .skills .views:hover, .theme-default .nivo-directionNav a:hover, .flexslider:hover .flex-next:hover, .flexslider:hover .flex-prev:hover, nav#widgetmenu li a:hover, nav#widgetmenu li:hover > a , nav#widgetmenu li.current-menu-item > a, nav#widgetmenu li.current-menu-ancestor > a { background-color: #e67e22; } a.more:hover, a:hover, #footer a:hover, #sidebar a:hover, .post-article .title a:hover, .post-info a:hover, .filterable-grid  h4.title a:hover, .filterable-grid  h4.title a:focus, #logo a:hover, #footer a:hover { color: #e67e22; } nav#mainmenu ul li a:hover,nav#mainmenu li:hover > a,nav#mainmenu ul li.current-menu-item > a, nav#mainmenu ul li.current_page_item > a, nav#mainmenu ul li.current-menu-parent > a, nav#mainmenu ul li.current_page_ancestor > a, nav#mainmenu ul li.current-menu-ancestor > a, nav#mainmenu ul ul li:last-of-type a:hover, nav#mainmenu ul ul li:last-of-type:hover > a, nav#mainmenu ul ul li.current-menu-item > a, nav#mainmenu ul ul li.current_page_item > a, nav#mainmenu ul ul li.current-menu-parent > a, nav#mainmenu ul ul li.current_page_ancestor > a, nav#mainmenu ul ul li.current-menu-ancestor > a, #back-to-top i.open, #back-to-top i:hover, ul.widget-category li a:hover, .tagcloud a:hover, .toggle_container h5.element:hover, .toggle_container h5.inactive, .toggle_container h5.inactive:hover, .toggle_container h5.element:hover:last-of-type, .toggle_container h5.inactive:last-of-type, .toggle_container h5.inactive:hover:last-of-type, .socials a:hover, #searchform input[type=submit]:hover, .contact-form input[type=submit]:hover, #commentform input[type=submit]:hover, nav#widgetmenu li a:hover, nav#widgetmenu li:hover > a , nav#widgetmenu li.current-menu-item > a, nav#widgetmenu li.current-menu-ancestor > a { border-color: #e67e22; } </style><style type="text/css">.broken_link, a.broken_link {
text-decoration: line-through;
}</style><style type="text/css" id="custom-background-css">
body.custom-background { background-color: #cecece; }
</style>
</head>
<body class="post-template-default single single-post postid-88 single-format-standard custom-background custombody" >
<header id="header">
<div class="container">
<div class="row">
<div class="col-md-12">
<div id="logo">
<a href="page/1/index.html" title="IT Traveler">
IT Traveler
</a>
</div>
<p></p>
Заметки одного системного администратора
<nav id="mainmenu" >
<ul id="menu-menyu" class="menu"><li id="menu-item-14" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-14"><a href="http://www.ittraveler.org">Главная</a></li>
<li id="menu-item-13" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-13"><a href="category/windows/page/1/index.html">Windows</a></li>
<li id="menu-item-15" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15"><a href="category/linux/page/1/index.html">Linux</a></li>
<li id="menu-item-16" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-16"><a href="category/webcloud/page/1/index.html">Web/Cloud</a></li>
<li id="menu-item-17" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-17"><a href="category/virtualizaciya/page/1/index.html">Виртуализация</a></li>
<li id="menu-item-18" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-18"><a href="category/seti/index.html">Сети</a></li>
<li id="menu-item-778" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-778"><a href="index.html@p=776.html">Поддержать автора</a></li>
</ul>
</nav> 
<div class="clear"></div>
</div>
</div>
</div>
</header>
<div class="container">
<div class="row">
<div class="col-md-12 full">
<div class="row">
<article class="post-88 post type-post status-publish format-standard hentry category-active-directory category-windows category-windows-server tag-active-directory tag-replikaciya post-container col-md-12" >
<script async src="http://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- Home ittraveler -->
<ins class="adsbygoogle"
style="display:block"
data-ad-client="ca-pub-1890562251101921"
data-ad-slot="9117958896"
data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>                
<div class="post-article post-title">	
<h1 class="title icon-title"> 
Управление репликацией Active Directory                	<span><i class="fa fa-pencil-square-o"></i></span>
</h1>
</div>
<div class="post-article">
<div class="line"> <span> Дата: 30.12.2014 Автор Admin </span> </div>
<p>Обеспечение корректной репликации в лесу <a href="tag/active-directory/page/1/index.html" class="st_tag internal_tag" rel="tag" title="Posts tagged with Active Directory">Active Directory</a> – это одна из главных задач администратора AD. В этой статье попытаемся понять базовые принципы репликации базы <a href="tag/active-directory/page/1/index.html" class="st_tag internal_tag" rel="tag" title="Posts tagged with Active Directory">Active Directory</a> и методики диагностики неисправности. Стоит отметить,  что репликации — один из основополагающих принципов построения современной корпоративной сети на базе AD, так, например, мы уже говорили о репликации групповых политик в домене AD и репликации зон DNS.<span id="more-88"></span></p>
<p>Для мониторинга репликации Active Directory в корпоративной среде Microsoft рекомендует использовать продукт SCOM (либо другие продукты мониторинга с похожим функционалом).  Кроме того, для  мониторинга репликации AD можно использовать утилиту repadmin (repadmin /showrepl * /csv) совместно с самописными скриптами анализа вывода этой утилиты. Типичные проблемы, связанные с ошибками репликации Active Directory,  — ситуации, когда объекты не появляются в одном или нескольких сайтах (например, только что созданный пользователь, группа или другой объект AD не доступны на контроллерах домена в других сайтах).</p>
<p>Хорошая отправная точка для поиска неисправности в механизме репликации Active Directory – анализ журнала «Directory Services» на контроллерах домена. Конкретные действия будут зависеть от того, какие ошибки будут обнаружены в журнале, однако для разрешения проблем нужно достаточно четко понимать процессы репликации Active Directory.</p>
<p>Одним из базовых элементов управлением трафиком репликации между контроллерами домена являются сайты Active Directory. Сайты связаны между собой особыми связями, называемыми «site link», которые определяют стоимость маршрутизации данных AD (элементы леса, домена, папка SYSVOL и т.д.) между различными сайтами. Расчет алгоритма управления и маршрутизации трафика репликации в лесу ведется службой KCC.</p>
<p>KCC определяет партнеров по репликации для всех контроллеров домена в лесу. Для межсайтовой репликации KCC автоматически выбирает специальные сервера-плацдармы (bridgehead server), помимо этого, администратор домена может вручную указать контролеры домена, которые будут выполнять роль сервера-плацдарма для того или иного сайта, именно эти сервера и управляют межсайтовой репликацией.   Сайты и сервера bridgehead нужны для того, чтобы удобно управлять трафиком репликации Active Directory, и чтобы уменьшить объем передаваемого трафика по сети.</p>
<p>Межсайтовую топологию в лесу можно проанализировать при помощи команды:</p>
<p>repadmin /showism<br />
данная команда отобразит список сайтов в лесу Active Directory.  Для каждого из сайтов указаны 3 значения: стоимость репликации между двумя сайтами, интервал репликации в минутах, а также дополнительные настроенные параметры межсайтовой связи. Вывод этой команды может выглядеть так:</p>
<p>C:\&gt;repadmin /showism</p>
<p>==== TRANSPORT CN=IP,CN=Inter-Site Transports,CN=Sites,CN=Configu</p>
<p>ration,DC=winitpro,DC=ru CONNECTIVITY INFORMATION FOR 3 SITES: ====</p>
<p>0,    1,    2</p>
<p>Site(0) CN=LAB-Site1,CN=Sites,CN=Configuration,DC=winitpro,DC=ru</p>
<p>0:0:0, 10:15:0, 10:30:0</p>
<p>All DSAs in site CN=ADP-ADSN,CN=Sites,CN=Configuration,DC=lab,</p>
<p>DC=net (with trans&amp; hosting NC) are bridgehead candidates.</p>
<p>Site(1) CN=LAB-Site2,CN=Sites,CN=Configuration,DC=winitpro,DC=ru</p>
<p>10:15:0, 0:0:0, 20:30:0</p>
<p>All DSAs in site CN=ADP-Intranet,CN=Sites,CN=Configuration,DC=la</p>
<p>b,DC=net (with trans &amp; hosting NC) are bridgehead candidates</p>
<p>Site(2) CN=LAB-Site3,CN=Sites,CN=Configuration,DC=winitpro,DC=ru</p>
<p>10:30:0, 20:30:0, 0:0:0</p>
<p>1 server(s) are defined as bridgeheads for transport CN=IP,CN=Int</p>
<p>er-Site Transports,CN=Sites,CN=Configuration,DC=winitpro,DC=ru &amp;</p>
<p>site CN=LAB-Site3,CN=Sites,CN=Configuration,DC=winitpro,DC=ru:</p>
<p>Server(0) CN=testlabdc2,CN=Servers,CN=LAB-Site3,CN=Sites,CN=Co</p>
<p>nfiguration,DC=winitpro,DC=ru</p>
<p>C:\&gt;<br />
В вышеприведённом логе видно, что в домене test.com существует 3 сайта, которые называется соответственно Site(0), Site(1) иSite(2).  Каждый из сайтов имеет 3 набора репликационной информации, по одной для каждого сайта в лесу. Например, настроена связь между Sites(2) (LAB-Site3) и Site(0) (LAB-Site1), параметры этой связи — 10:30:0, что означает: 10 – стоимость репликации, и интервал репликации  30 минут.  Также обратите внимание, что для сайта Site(2) задан сервер-плацдарм (bridgehead) – это контроллер домена с именем testlabdc2.</p>
<p>Контроллеры домена, партнеры по репликации – могут быть идентифицированы при помощи графического Gui или при помощи утилит командной строки. Откройте консоль    MMC «Active Directory Sites and Services», разверните узел  Sites, в нем найдите интересующий ваш сайт. В этом узле будут содержатся контроллеры домена, относящиеся к этому сайту. Развернув контроллер домена и выбрав пункт NTDS Settings, вы увидите всех партнеров по репликации данного контроллера домена.</p>
<p><img class="alignnone" src="http://winitpro.ru//wp-content/uploads/2011/07/ntds_setting_ad.jpg" alt="" width="452" height="160" /></p>
<p>В командной строке при помощи команды nslookup можно получить список контроллеров домена, относящихся к нашему сайту (естественно для этого необходимо,  чтобы все DC имели корректные записи SRV).  Формат команды такой:</p>
<p>nslookup -type=srv _ldap._tcp.._sites.dc._<br />
на выходе получаем примерно следующее:</p>
<p>C:\&gt;</p>
<p>_ldap._tcp.LAB-Site1._sites.dc._msdcs.test.com SRV service location</p>
<p>priority       = 0</p>
<p>weight         = 100</p>
<p>port           = 389</p>
<p>svr hostname   = testlabdc1.test.com</p>
<p>_ldap._tcp.LAB-Site1._sites.dc._msdcs.test.com SRV service location</p>
<p>priority       = 0</p>
<p>weight         = 100</p>
<p>port           = 389</p>
<p>svr hostname   = testlabdc2.test.com</p>
<p>testlabdc1.test.com       internet address = 172.21.23.13</p>
<p>testlabdc2.test.com       internet address = 172.21.23.16<br />
Чтобы для определенного контролера домена отобразить всех партнеров по репликации, с датой и временем  последней репликации, воспользуйтесь командой:</p>
<p>repadmin /showrepl<br />
Стоит отметить, что служба DNS – это важный компонент службы репликации Active Directory. Контроллеры домена регистрируют свои SRV записи в DNS.   Каждый контроллер домена в лесу регистрирует записи CNAME вида dsaGuid._msdcs.forestName, где dsaGuid –GUID видимый у объекта в пункте NTDS Settings в консоли «AD Sites and Services». Если в журнале Directory Services есть ошибки, связанные со службой DNS, для проверки корректных записей  типа CNAME и A для контроллера домена.</p>
<p>dcdiag /test:connectivity<br />
Если будут ошибки, перезапустите службу Netlogon, в результате чего произойдет перерегистрация отсутствующих dns записей. Если dcdiag все также будет выдавать ошибки, проверьте конфигурацию службы DNS и корректность DNS настроек на DC. Для более детального знакомства с темой тестирования служб dns, рекомендую обратиться к статье Диагностика проблем с поиском контроллера домена.</p>
<p>Команда repadmin имеет специальный параметр /replsummary, который позволяет быстро проверить состояние репликации на конкретном контроллере домена (указывается его имя) или на всех контроллерах (опция wildcard).</p>
<p>repadmin /replsummary [targetDC|wildcard]<br />
В том случае, если ошибки репликации отсутствуют, в выводе этой команды будет видно, что ошибок – 0.:</p>
<p>C:\&gt;repadmin /replsummary testlabdc2</p>
<p>Replication Summary Start Time: 2010-01-24 15:56:03</p>
<p>Beginning data collection for replication summary, this may take a</p>
<p>while:</p>
<p>&#8230;.</p>
<p>Source DSA       largest delta    fails/total  %% error</p>
<p>testlabdc1           06m:27s       0 /   3    0</p>
<p>testlabdc3           06m:27s       0 /   6    0</p>
<p>testlabdc4           06m:27s       0 /   5    0</p>
<p>Destination DSA  largest delta    fails/total  %% error</p>
<p>testlabdc3           06m:27s       0 /  14    0</p>
<p>C:\&gt;<br />
В том случае, если ошибки все-таки будут, при помощи утилиты Repadmin можно получить более полную информацию. Каждый контроллер домена имеет собственный   уникальный USN (Update Sequence Number), который инкрементируется каждый раз при успешном изменении обновлении  объекта Active Directory. При инициализации репликации, партнеру передается USN, который сравнивается с USN, полученным в результате последней успешной репликации  с данным партнером, тем самым определяя сколько изменений произошло в базе AD со времени последней репликации.</p>
<p>При помощи ключа /showutdvec, можно получить список текущих значений USN, хранящихся на указанном DC.</p>
<p>repadmin /showutdvec<br />
например</p>
<p>C:\&gt;repadmin /showutdvec  testlabdc4 DC=test,DC=ru</p>
<p>Caching GUIDs.</p>
<p>&#8230;.</p>
<p>LAB-Site1\testlabdc1   @ USN  16608532 @ Time 2010-01-24 16:27:11</p>
<p>LAB-Site1\testlabdc2   @ USN    307126 @ Time 2010-01-24 16:27:27</p>
<p>LAB-Site2\testlabdc3   @ USN 297948217 @ Time 2010-01-24 16:19:34</p>
<p>LAB-Site3\testlabdc4   @ USN 245646728 @ Time 2010-01-24 16:19:36</p>
<p>C:\&gt;<br />
Запустив эту команду на контроллере домена, на котором наблюдаются проблемы с репликацией, можно понять насколько различаются базы AD, просто сравнив значения USN.</p>
<p>Тестирование репликации  Active Directory при помощи утилиты  repadmin можно осуществить несколькими способами:</p>
<p>replmon /replicate &lt;targetDC&gt; &lt;sourceDC&gt; &lt;dirPartition&gt; (позволяет запустить репликацию определенного раздела на указанный контроллер домена)<br />
replmon /replsingleobj &lt;targetDC&gt; &lt;sourceDC&gt; &lt;objPath&gt; (репликация конкретного объекта между двумя DC)<br />
replmon /syncall &lt;targetDC&gt; (синхронизация указанного контроллера домена со всем партнерами по репликации)<br />
C:\&gt;repadmin /replicate testlabdc1 testlabdc3 DC=test,DC=ru</p>
<p>Sync from testlabdc3 to testlabdc1 completed successfully.</p>
<p>C:\&gt;repadmin /replsingleobj testlabdc1 testlabdc3 cn=stuart,ou=dsu</p>
<p>sers,DC=test,DC=ru</p>
<p>Successfully replicated object cn=stuart,ou=dsusers,DC=test,DC=ru</p>
<p>to testlabdc1 from .</p>
<p>C:\&gt;repadmin /replsingleobj testlabdc1 testlabdc3 ou=dsusers,dc=la</p>
<p>b,dc=net</p>
<p>Successfully replicated object ou=dsusers,DC=test,DC=ru to testlab</p>
<p>dc1 from .</p>
<p>C:\&gt;repadmin /replsingleobj testlabdc1 testlabdc3 DC=winitpro,DC=ru</p>
<p>Successfully replicated object DC=test,DC=ru to testlabdc1 from</p>
<p>.</p>
<p>C:\&gt;repadmin /syncall testlabdc3</p>
<p>CALLBACK MESSAGE: The following replication is in progress:</p>
<p>From: 25fdc051-6ff6-4922-bc02-0b77a4652bfc._msdcs.test.com</p>
<p>To  : 99305007-2290-489b-9551-20827ba0664d._msdcs.test.com</p>
<p>CALLBACK MESSAGE: The following replication completed successfully</p>
<p>From: 25fdc051-6ff6-4922-bc02-0b77a4652bfc._msdcs.test.com</p>
<p>To  : 99305007-2290-489b-9551-20827ba0664d._msdcs.test.com</p>
<p>CALLBACK MESSAGE: The following replication is in progress:</p>
<p>From: b0870af5-ab82-4372-9e39-0a9772a5e47c._msdcs.test.com</p>
<p>To  : 99305007-2290-489b-9551-20827ba0664d._msdcs.test.com</p>
<p>CALLBACK MESSAGE: The following replication completed successfully</p>
<p>From: b0870af5-ab82-4372-9e39-0a9772a5e47c._msdcs.test.com</p>
<p>To  : 99305007-2290-489b-9551-20827ba0664d._msdcs.test.com</p>
<p>CALLBACK MESSAGE: SyncAll Finished.</p>
<p>SyncAll terminated with no errors.</p>
<p>C:\&gt;<br />
При наличии проблем с механизмом репликации Active Directory, нужно знать и уметь пользоваться утилитами repadmin, nslookup, dcdiag, крайне полезен при анализе журнал событий Directory Services. В особо сложный  и нестандартных ситуациях может помочь база знаний Microsoft KB, в которой описаны типовые проблемы и методики их решения. Поиск по базе KB обычно осуществляется по идентификаторам ошибок (Event ID), полученным из указанного журнала..</p>
<p>Источник &#8212;<a href="http://ittraveler.org/upravlenie-replikaciej-active-directory/%20http://winitpro.ru/index.php/2011/07/01/upravlenie-replikaciej-active-directory/"> http://winitpro.ru/index.php/2011/07/01/upravlenie-replikaciej-active-directory/ </a></p>
<div class="wp_rp_wrap  wp_rp_plain" id="wp_rp_first"><div class="wp_rp_content"><h3 class="related_post_title">Похожие статьи</h3><ul class="related_post wp_rp"><li data-position="0" data-poid="in-85" data-post-type="none" ><a href="index.html@p=85.html" class="wp_rp_title">Переход на репликацию SYSVOL по DFS</a></li><li data-position="1" data-poid="in-46" data-post-type="none" ><a href="index.html@p=46.html" class="wp_rp_title">Восстановление объектов Active Directory: сборник сценариев</a></li><li data-position="2" data-poid="in-70" data-post-type="none" ><a href="index.html@p=70.html" class="wp_rp_title">Передача и захват ролей FSMO</a></li><li data-position="3" data-poid="in-79" data-post-type="none" ><a href="index.html@p=79.html" class="wp_rp_title">Аудит изменений в Active Directory</a></li><li data-position="4" data-poid="in-61" data-post-type="none" ><a href="index.html@p=61.html" class="wp_rp_title">Обновление схемы Active Directory</a></li><li data-position="5" data-poid="in-73" data-post-type="none" ><a href="index.html@p=73.html" class="wp_rp_title">Активируем LDAP over SSL</a></li></ul></div></div>
<div class="clear"></div>
<div class="post-info">
<div class="left"> <a href="category/active-directory/page/1/index.html" rel="category tag">Active Directory</a>, <a href="category/windows/page/1/index.html" rel="category tag">Windows</a>, <a href="category/windows-server/page/1/index.html" rel="category tag">Windows Server</a> </div>
<div class="right"> Метки: <a href="tag/active-directory/page/1/index.html" rel="tag">Active Directory</a>, <a href="tag/replikaciya/index.html" rel="tag">Репликация</a>  </div>
</div>
<div class="clear"></div>
<br>
</div>                        
<div style="clear:both"></div>
</article>
<div class="clear"></div>
<section class="col-md-12">
<div id="respond" class="comment-respond">
<h3 id="reply-title" class="comment-reply-title">Добавить комментарий <small><a rel="nofollow" id="cancel-comment-reply-link" href="index.html@p=88.html#respond" style="display:none;">Отменить ответ</a></small></h3>			<form action="http://ittraveler.org/wp-comments-post.php" method="post" id="commentform" class="comment-form">
<p class="comment-notes"><span id="email-notes">Ваш e-mail не будет опубликован.</span></p><p class="comment-form-comment"><label for="comment">Комментарий</label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea></p><p class="comment-form-author"><label for="author">Имя</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">E-mail</label> <input id="email" name="email" type="text" value="" size="30" maxlength="100" aria-describedby="email-notes" /></p>
<p class="comment-form-url"><label for="url">Сайт</label> <input id="url" name="url" type="text" value="" size="30" maxlength="200" /></p>
<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Комментировать" /> <input type='hidden' name='comment_post_ID' value='88' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="3313bf0ed4" /></p><p style="display: none;"><input type="hidden" id="ak_js" name="ak_js" value="221"/></p>			</form>
</div><!-- #respond -->
<script async src="http://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- Home ittraveler -->
<ins class="adsbygoogle"
style="display:block"
data-ad-client="ca-pub-1890562251101921"
data-ad-slot="9117958896"
data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</section>
</div>
</div>
<div class="clear"></div>
</div>
</div>
<div id="back-to-top"> <i class="fa fa-chevron-up"></i> </div>
<footer id="footer">
<div class="container">
<div class="row" >
<div class="col-md-12" >
<div class="copyright">
<p>
Все права защищены. IT Traveler 2019 
</p>
</div>
<div class="socials">
<a href="feed/index.html" title="Rss" class="social rss"> <i class="fa fa-rss" ></i>  </a>                         
</div>
<div class="clear"></div>
</div>
</div>
</div>
</footer>
<!-- Lightbox Plus Colorbox v2.7.2/1.5.9 - 2013.01.24 - Message: 0-->
<script type="text/javascript">
jQuery(document).ready(function($){
$("a[rel*=lightbox]").colorbox({initialWidth:"30%",initialHeight:"30%",maxWidth:"90%",maxHeight:"90%",opacity:0.8,current:" {current}  {total}",previous:"<-",next:"->",close:"Закрыть"});
});
</script>
<script type='text/javascript' src='wp-includes/js/comment-reply.min.js@ver=5.2.4'></script>
<script type='text/javascript' src='wp-includes/js/jquery/ui/core.min.js@ver=1.11.4'></script>
<script type='text/javascript' src='wp-includes/js/jquery/ui/widget.min.js@ver=1.11.4'></script>
<script type='text/javascript' src='wp-includes/js/jquery/ui/tabs.min.js@ver=1.11.4'></script>
<script type='text/javascript' src='http://ittraveler.org/wp-content/themes/diarjo-lite/js/jquery.tinynav.js?ver=5.2.4'></script>
<script type='text/javascript' src='http://ittraveler.org/wp-content/themes/diarjo-lite/js/jquery.scrollTo.js?ver=5.2.4'></script>
<script type='text/javascript' src='http://ittraveler.org/wp-content/themes/diarjo-lite/js/jquery.easing.1.3.js?ver=5.2.4'></script>
<script type='text/javascript' src='http://ittraveler.org/wp-content/themes/diarjo-lite/js/jquery.wip.js?ver=5.2.4'></script>
<script type='text/javascript' src='http://ittraveler.org/wp-content/themes/diarjo-lite/js/jquery.prettyPhoto.js?ver=5.2.4'></script>
<script type='text/javascript' src='http://ittraveler.org/wp-content/plugins/lightbox-plus/js/jquery.colorbox.1.5.9-min.js?ver=1.5.9'></script>
<script type='text/javascript' src='wp-includes/js/wp-embed.min.js@ver=5.2.4'></script>
<script async="async" type='text/javascript' src='http://ittraveler.org/wp-content/plugins/akismet/_inc/form.js?ver=4.1.2'></script>
<!-- Yandex.Metrika counter -->
<script type="text/javascript">
(function (d, w, c) {
(w[c] = w[c] || []).push(function() {
try {
w.yaCounter27780774 = new Ya.Metrika({
id:27780774,
clickmap:true,
trackLinks:true,
accurateTrackBounce:true,
webvisor:true,
trackHash:true
});
} catch(e) { }
});
var n = d.getElementsByTagName("script")[0],
s = d.createElement("script"),
f = function () { n.parentNode.insertBefore(s, n); };
s.type = "text/javascript";
s.async = true;
s.src = "https://mc.yandex.ru/metrika/watch.js";
if (w.opera == "[object Opera]") {
d.addEventListener("DOMContentLoaded", f, false);
} else { f(); }
})(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/27780774" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
<!-- /Yandex.Metrika counter -->
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-58126221-1', 'auto');
ga('send', 'pageview');
</script>
</body>
</html><!-- WP Fastest Cache file was created in 3.1225740909576 seconds, on 28-10-19 21:10:17 -->